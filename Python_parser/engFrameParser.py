# definig the maping 
cap_to_data = {
    "0" : "0",
    "1" : "7",
    "2" : "8",
    "3" : "10",
    "4" : "12",
    "5" : "14",
    "6" : "16",
    "7" : "18",
    "8" : "20",
    "9" : "22",
    "C" : "24",
    "D" : "26",
    "E" : "28",
    "F" : "4",
    "G" : "5",
    "H" : "6"
}

capacity_to_data = {
    "1" : "2.8",
    "2" : "3.5",
    "3" : "4.6",
    "4" : "5.3",
    "5" : "7.0",
    "6" : "7.7",
    "7" : "8.8",
    "8" : "10.5",
    "9" : "12.3",
    "@" : "14.1",
    "A" : "17.6",
    "B" : "19.3",
    "C" : "21.1",
    "D" : "23.9",
    "E" : "28.1",
    "F" : "35.2",
    "G" : "2.3",
    "H" : "6.0",
    "I" : "8.1",
    "J" : "10.0",
    "K" : "11.3",
    "L" : "44.0",
    "M" : "52.7",
    "N" : "70.3",
    "O" : "87.9",
    "P" : "105.5"
}

def parse_frame(frame):
    parsed_data = {
        "idu_qty" : int(frame[7:9], 16),
        "tsc_new" : int(frame[27:31], 16),
        "odu_mode" : int(frame[43]),
        "master_cap" : cap_to_data.get(frame[61]),
        "slave1_cap" : cap_to_data.get(frame[93]),
        "slave2_cap" : cap_to_data.get(frame[125]),
        "slave3_cap" : cap_to_data.get(frame[157]),
        "master_err" : frame[401:403],
        "slave1_err" : frame[470:472],
        "slave2_err" : frame[539:541],
        "slave3_err" : frame[608:610],
        "sid" : int(frame[4781 : 4783], 16)
    }

    # IDU
    parsed_data["idus"] = []
    for i in range(0, parsed_data["idu_qty"]):
        num = i * 65
        idu = {
            "mode" :  int(frame[751 + num]),
            "status" :  int(frame[752 + num]),
            "err " : frame[753 + num : 755 + num],
            "c_temp" : f"{int(frame[760 + num : 764 + num], 16) / 10}",
            "capacity" : capacity_to_data.get(frame[768 + num]),
            "model_name" : frame[769 + num],
            "thermostat" : int(frame[778 + num]),
            "fspd" : int(frame[780 + num]),
            "stemp" : f"{int(frame[781 + num : 783 + num], 16)}",
            "swing" : {
                "value" : int(frame[785 + num]),
                "pos" : int(frame[784 + num])
            },
            "exv_step" : f"{frame[786 + num]}{int(frame[787 + num : 791 + num], 16)}",
            "delta_tcoil" : f"{int(frame[791 + num : 795 + num], 16) / 10}",
            "on_lock" : int(frame[800 + num]),
            "off_lock" : int(frame[801 + num]),
            "mode_lock" : int(frame[802 + num]),
            "temp_lock" : int(frame[803 + num]),
            "sleep" : int(frame[812 + num])
        }
        parsed_data["idus"].append(idu)

    return parsed_data

# Example usage:
frame_1 = '*MDXXI00111C001C00900000000000000000000000020010112000900000030000000000500001470147000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000101002003004000000+19+190FA0FA000000000000000000+0FA+0FA+0FA+0FA+0FA0000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000+005 0A8C 0000 0000 0000 00 00110000+32+0FA+0F012+000+0F505110001a01E0+00551117000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X01E031DBA#'
frame_2 = '*MDXXI00111C001C00900000000000000000000000022010112001000000030000000000700001470147000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E01E06000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000101002003004000000+19+190FA0FA000000000000000000+0FA+0FA+0FA+0FA+0FA0000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000+005 0A8C 0000 0000 0000 00 00210064+5F+0FF+0F012+000+0F515410101a01E0+00540117000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X01E03F3F6#'
frame_3 = '*MDXXI00111C001C009001C001A001C001C001100112201011200120000003001C000000901001470147000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001101E01E00000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000101002003004000000+19+190FA0FA000000000000000000+0FA+0FA+0FA+0FA+0FA0000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+00000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000+001 0AAA 0033 0000 0000 00 00210044+0F+0FF+0F012+000+0F515418101a0064+00440117000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X01E030716#'
frame_4 = '*MDXXI00111C001C009001C002A001C001C001C001C2201011200130000003001C000000901001470147000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001101E01E00000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000000000000000000000000001E01E00000000101002003004000000+19+190FA0FA000000000000000000+0FA+0FA+0FA+0FA+0FA0000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+0000000000000000000000+00+00000000000000000000000000+000+000+000+000+00000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000+001 0B09 0033 0000 0000 00 00210064+4B+0FF+0F012+000+0F515412101a0064+00540117000000000000100X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X000000+00+000+00001+000+00005000001a0000+00000000000000000000000X01E032274#'
frame = frame_2
parsed_data = parse_frame(frame)

        
print(parsed_data)
